### 第四题，字符串hash

![image-20200126140259610](C:\Users\zjq\AppData\Roaming\Typora\typora-user-images\image-20200126140259610.png)

- long long 是2的63的正数，ull是2的64的正数
- 字符串hash ：就是`（hash[i-1]*chash+text[i-1])%MOD;`这里的mod就是2的64，因为会溢出。

```C++
#define ull unsigned long long
const int maxn=2040;
const int hashmap=37;
ull chash[maxn],zhash[maxn];

class Solution {
public:
    int nxt[2004];
    
    int distinctEchoSubstrings(string text) {
        set<ull> s;
        int n=text.length();
        zhash[0]=1;
        for(int i=1;i<=n;i++){
            chash[i]=chash[i-1]*37+text[i-1];
            zhash[i]=zhash[i-1]*37;
        }
        for(int i=1;i<=n;i++)
        {
            ull now=0;
            for(int j=i;j<=n;j++){
                now=now*37+text[j-1];
                int len=j-i+1;
                int st=j+1,en=j+len;
                if(en>n)break;
                ull a=(chash[j]-chash[i-1])*zhash[len];
                ull b=chash[en]-chash[st-1];
                if(a==b){
                    s.insert(a);
                }
            }
        }
        return s.size();
    }
};
```



