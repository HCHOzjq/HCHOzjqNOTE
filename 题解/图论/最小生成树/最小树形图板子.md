```C++
#include<bits/stdc++.h>

using namespace std;
const int maxn=10005;
struct edge
{
	int u,v,val;
	int b; 
}e[maxn],by[maxn];
int in[maxn];
int vis[maxn];
int idx[maxn];
int pre[maxn];
const int inf=0x3f3f3f3f;
int mid;
int cost;
int zhuliu(int root,int totn,int totm)
{
	int x,y,ans=0;
	int rt;
	while(true)
	{
		memset(pre,-1,sizeof pre);
		for(int i=0;i<=totn;i++)in[i]=inf;
		for(int i=0;i<totm;i++){
			int u=e[i].u,v=e[i].v;
			if(e[i].b<mid)continue;
			if(u!=v&&in[v]>e[i].val){
				in[v]=e[i].val;
				pre[v]=u;
				if(e[i].u==root)rt=i;
			}
		}
		for(int i=0;i<=totn;i++)if(in[i]==inf&&i!=root)return false;
		int tot=0;
		memset(vis,-1,sizeof vis);
		memset(idx,-1,sizeof idx);
		in[root]=0;
		for(int i=0;i<=totn;i++){
			ans+=in[i];
			y=i;
			while(vis[y]!=i&&idx[y]==-1&&y!=root){
				vis[y]=i; 
				y=pre[y];
			}
			if(y!=root&&idx[y]==-1){
				for(x=pre[y];x!=y;x=pre[x]){
					idx[x]=tot;//cout<<x<<endl;
				} 
					
				idx[y]=tot++;
			}
		}
		if(!tot)break;
		for(int i=0;i<=totn;i++)if(idx[i]==-1)idx[i]=tot++;
		for(int i=0;i<totm;i++){
			int u=e[i].u;
			int v=e[i].v;
			//if(e[i].b<mid)continue;
			e[i].u=idx[u];
			e[i].v=idx[v];
			if(e[i].u!=e[i].v)
			{
				e[i].val-=in[v];
			}
			
		}totn=tot-1;
			root=idx[root];
	}
	return ans<=cost;
}

int main()
{
	int t;scanf("%d",&t);
	
	while(t--)
	{
		int n,m;
		scanf("%d%d%d",&n,&m,&cost);
		int l=0x3f3f3f3f,r=-0x3f3f3f3f;
		for(int i=0;i<m;i++){
			int a,b,c,d;
			scanf("%d%d%d%d",&e[i].u,&e[i].v,&e[i].b,&e[i].val);
			by[i]=e[i];
			 
			l=min(e[i].b,l);
			r=max(e[i].b,r);
		}
		int ans=0;
		mid=0;
		if(!zhuliu(0,n-1,m)) {
			puts("streaming not possible.");
			continue;
		}
		while(l<r)
		{
			mid=l+(r-l)/2;
			for(int i=0;i<m;i++){
				e[i]=by[i];
			}
			int t=zhuliu(0,n-1,m);
			if(t){
				l=mid+1;
				ans=(ans,mid);
			}else {
				r=mid;
			}
		}
		printf("%d kbps\n",ans);
	}
}
```

uva11856，板子题，emm二分求得，具体看代码可以看懂，可能我以后看不懂了吧。。