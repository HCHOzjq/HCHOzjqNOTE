```C++
#include<iostream>
#include<cstdio>
#include<cstring>
#include<stack>
using namespace std;
const int maxn=2*100004;
struct edge
{
	int v,nxt;
}e[maxn];
int cnt; 
int head[maxn];
void add_edge(int u,int v)
{
	e[cnt].v=v;
	e[cnt].nxt=head[u];
	
	head[u]=cnt++;
}

stack<int> s;
int vis[maxn];
int boy;
bool dfs(int u)
{
	//cout<<u<<endl;
	if(vis[u^1]||((u^1)==boy))return false;
	if(vis[u])return true;
	vis[u]=true;
	s.push(u);
	for(int i=head[u];i!=-1;i=e[i].nxt)
	{
		int v=e[i].v;
		if(!dfs(v))return false;
	}
	return true;
}

bool Twosat(int n)
{
	memset(vis,0,sizeof vis);
	while(!s.empty())s.pop();
	for(int i=0;i<n;i+=2)
	{
		if(vis[i]||vis[i^1])continue;
		while(!s.empty())s.pop();
		if(!dfs(i))
		{
			while(!s.empty())vis[s.top()]=false,s.pop();
			if(!dfs(i^1))return false;
		}
	}
	return true;
}

int main()
{
	int n,m;
	while(cin>>n>>m&&n&&m)
	{
		boy=0;
		memset(head,-1,sizeof  head);
		cnt=0;
		while(m--)
		{
			int u,v;char a,b;
			scanf("%d%c %d%c",&u,&a,&v,&b);
			if(a=='h')u=u*2;else u=u*2+1;
			if(b=='h')v=v*2;else v=v*2+1;
			if(u==1||v==1)continue;
			add_edge(u,v^1);
			add_edge(v,u^1);
		}
		if(Twosat(2*n)){
			for(int i=2;i<2*n;i+=2){
				if(i!=2)cout<<" ";
				printf("%d%c",(i)/2,(vis[i]?'w':'h'));
			}
			cout<<endl;
		}else {
			cout<<"bad luck"<<endl;
		}
	}
}
```

